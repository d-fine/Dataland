FROM eclipse-temurin:21.0.9_10-jdk-jammy@sha256:81ad1240d91eeafe1ab4154e9ed2310b67cb966caad1d235232ae10abcb1fae2 AS builder

WORKDIR /app

COPY ./gradle/ ./gradle/
COPY ./gradlew .
RUN  ./gradlew --version
COPY ./build.gradle.kts ./gradle.properties ./settings.gradle.kts ./versions.properties ./

# Gradle 9 requires all included project directories to exist at settings evaluation time
RUN mkdir -p \
    dataland-accounting-service \
    dataland-backend-utils \
    dataland-backend \
    dataland-api-key-manager \
    dataland-data-sourcing-service \
    dataland-internal-storage \
    dataland-e2etests \
    dataland-frontend \
    dataland-keycloak/dataland_theme/login \
    dataland-keycloak-adapter \
    dataland-qa-service \
    dataland-message-queue-utils \
    dataland-document-manager \
    dataland-batch-manager \
    dataland-framework-toolbox \
    dataland-community-manager \
    dataland-email-service \
    dataland-external-storage \
    dataland-dummy-eurodat-client \
    dataland-data-exporter \
    dataland-specification-lib \
    dataland-specification-service \
    dataland-user-service \
    dataland-reduced-local-stack

RUN ./gradlew --no-daemon --stacktrace
