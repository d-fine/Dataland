// <--WARNING--> THIS FILE IS AUTO-GENERATED BY THE FRAMEWORK-TOOLBOX AND WILL BE OVERWRITTEN
package ${package}

import jakarta.validation.Constraint
import jakarta.validation.ConstraintValidator
import jakarta.validation.ConstraintValidatorContext
import jakarta.validation.Payload
import ${frameworkSpecificImport} //import org.dataland.datalandbackend.frameworks.${smallFramework}.model.${framework}Data
import org.dataland.datalandbackend.model.documents.CompanyReport


@Constraint(validatedBy = [ReferencedReportsListValidatorFor${framework}::class])
@Target(AnnotationTarget.FIELD, AnnotationTarget.CLASS)
annotation class ValidateReferencedReportsList${framework}(
val message: String = "The list of referenced reports is not complete.",
val groups: Array<KClass<*>> = [],
val payload: Array<KClass<out Payload>> = [],
    )

class ReferencedReportsListValidatorFor${framework} :
    ConstraintValidator<ValidateReferencedReportsList${framework}, ${framework}Data> {
    private val referencedReportsMap = ${referencedReportsMap}
    private val extendedDocumentsFileReferences = ${extendedDocumentsFileReferences}

    override fun isValid(value: ${framework}Data?, context: ConstraintValidatorContext?): Boolean {
        if (value == null) {
            return false
        }
        val referencedReportsFileReference = getFileReferencesFromReports(referencedReportsMap)

        return extendedDocumentsFileReferences.all {
            referencedReportsFileReference.contains(it)
        }
    }
    private fun getFileReferencesFromReports(map: Map<String, CompanyReport>?): List<String> {
        val referencedReportsList = mutableListOf<String>()
            for (entry in map?.entries!!) {
                referencedReportsList.add(entry.value.fileReference)
            }
        return referencedReportsList
    }
}