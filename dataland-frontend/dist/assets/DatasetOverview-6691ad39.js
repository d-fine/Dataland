import{a as I}from"./ApiClients-c2d52430.js";import{a as k,T as S}from"./TheHeader-0690a93c.js";import{T as C}from"./TheFooter-3b777f63.js";import{s as R,a as $}from"./column.esm-4af04ca3.js";import{h as N}from"./StringHumanizer-b303955c.js";import{s as O}from"./inputtext.esm-51fe2afe.js";import{c as P}from"./DataFormatUtils-9e016aeb.js";import{D as F,g as L}from"./DatasetStatusBadge-eef2213d.js";import{d as b,_ as w,r as a,o as l,c,f as t,w as o,h as B,v as T,a as n,j as _,i as M,M as U,N as A,e as x,n as g,x as E}from"./index-2a0d7e9b.js";import{D as V}from"./DatasetsTabMenu-52aae5cd.js";import{N as K}from"./NewDatasetButton-9f46ca6a.js";import"./dropdown.esm-db79d236.js";import"./virtualscroller.esm-6815c49e.js";import"./index.esm-e4a4c290.js";import"./index.esm-53a24283.js";import"./index.esm-cdf29d06.js";import"./qa-status-272129d3.js";import"./index.esm-64549a61.js";const z=b({name:"DatasetOverviewTable",mounted(){this.displayedDatasetTableInfos=this.datasetTableInfos},components:{DatasetStatusBadge:F,DataTable:R,Column:$,InputText:O},data(){return{searchBarInput:"",displayedDatasetTableInfos:[],humanizeString:N,convertDate:P,loading:!1,latestSearchString:""}},props:{datasetTableInfos:{type:Array,default:[]}},watch:{searchBarInput(e){this.applySearchFilter(e)},datasetTableInfos(){this.displayedDatasetTableInfos=this.datasetTableInfos}},methods:{getTableRowLinkTarget(e){return`/companies/${e.companyId}/frameworks/${e.dataType}/${e.dataId}`},applySearchFilter(e){this.loading=!0;let i;const d=e.toLowerCase();d.includes(this.latestSearchString.toLowerCase())?i=this.displayedDatasetTableInfos:i=this.datasetTableInfos,this.displayedDatasetTableInfos=i.filter(p=>p.companyName.toLowerCase().includes(d)),this.latestSearchString=d,this.loading=!1},rerouteRowClick(e){this.$router.push(this.getTableRowLinkTarget(e.data))}}});const H={class:"col-12 text-left"},W={class:"w-12 p-input-icon-left p-input-icon-right"},j=n("i",{class:"pi pi-search pl-3 pr-3","aria-hidden":"true",style:{color:"#958d7c"}},null,-1),q={key:0,class:"pi pi-spin pi-spinner right-0 mr-3","aria-hidden":"true"},Y=n("div",{class:"text-right"},[n("span",null,"VIEW"),n("span",{class:"ml-3"},">")],-1);function G(e,i,d,p,D,y){const r=a("Column"),u=a("DatasetStatusBadge"),h=a("InputText"),m=a("router-link"),f=a("DataTable");return l(),c("div",H,[t(f,{value:e.displayedDatasetTableInfos,id:"dataset-overview-table",class:"table-cursor mt-1",paginator:!0,rows:100,alwaysShowPaginator:!1,paginatorTemplate:"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport",currentPageReportTemplate:"Showing {first} to {last} of {totalRecords} entries",rowHover:!0,onRowClick:e.rerouteRowClick,sortField:"uploadTimeInMs",sortOrder:-1,"data-test":"datasets-table"},{default:o(()=>[t(r,{field:"companyName",header:"COMPANY",sortable:!0,class:"w-3 data-test-company-name"}),t(r,{field:"dataType",header:"DATA FRAMEWORK",sortable:!0,sortField:"dataType",class:"w-3"},{body:o(({data:s})=>[B(T(e.humanizeString(s.dataType)),1)]),_:1}),t(r,{field:"dataReportingPeriod",header:"REPORTING PERIOD",sortable:!0}),t(r,{field:"status",header:"STATUS",sortable:!0},{body:o(({data:s})=>[t(u,{"dataset-status":s.status},null,8,["dataset-status"])]),_:1}),t(r,{field:"uploadTimeInMs",header:"SUBMISSION DATE",sortable:!0,sortField:"uploadTimeInMs",class:"w-2"},{body:o(({data:s})=>[n("span",null,T(e.convertDate(s.uploadTimeInMs)),1)]),_:1}),t(r,{field:"companyName",header:"",class:"w-2 d-bg-white d-datatable-column-right"},{header:o(()=>[n("span",W,[j,t(h,{modelValue:e.searchBarInput,"onUpdate:modelValue":i[0]||(i[0]=s=>e.searchBarInput=s),placeholder:"Search table",class:"w-12 pl-6 pr-6"},null,8,["modelValue"]),e.loading?(l(),c("i",q)):_("",!0)])]),body:o(({data:s})=>[t(m,{to:e.getTableRowLinkTarget(s),class:"text-primary no-underline font-bold"},{default:o(()=>[Y]),_:2},1032,["to"])]),_:1})]),_:1},8,["value","onRowClick"])])}const J=w(z,[["render",G]]),Q=b({name:"DatasetOverview",components:{NewDatasetButton:K,DatasetsTabMenu:V,AuthenticationWrapper:I,TheHeader:k,TheContent:S,TheFooter:C,DatasetOverviewTable:J},data(){return{datasetTableInfos:[],waitingForData:!0,hasUserUploaderRights:void 0}},setup(){return{getKeycloakPromise:M("getKeycloakPromise")}},created(){U(A,this.getKeycloakPromise).then(e=>{this.hasUserUploaderRights=e}).catch(e=>console.log(e)),this.requestDataMetaDataForCurrentUser().catch(e=>console.log(e))},methods:{requestDataMetaDataForCurrentUser:async function(){this.datasetTableInfos=await L(x(this.getKeycloakPromise)),this.waitingForData=!1}}}),X={class:"col-12 flex flex-row justify-content-between align-items-end"},Z={key:0,class:"inline-loading text-center"},ee=n("p",{class:"font-medium text-xl"},"Loading datasets...",-1),te=n("i",{class:"pi pi-spinner pi-spin","aria-hidden":"true",style:{"z-index":"20",color:"#e67f3f"}},null,-1),ae=[ee,te],se={key:1},oe=n("h1",{class:"mb-0","data-test":"noDatasetUploadedText"},"No datasets uploaded",-1),ne=[oe];function re(e,i,d,p,D,y){const r=a("TheHeader"),u=a("NewDatasetButton"),h=a("DatasetOverviewTable"),m=a("DatasetsTabMenu"),f=a("TheContent"),s=a("TheFooter"),v=a("AuthenticationWrapper");return l(),g(v,null,{default:o(()=>[t(r),t(f,{class:"paper-section relative"},{default:o(()=>[t(m,{"initial-tab-index":1},{default:o(()=>[n("div",X,[e.hasUserUploaderRights?(l(),g(u,{key:0})):_("",!0)]),t(h,{"data-test":"datasetOverviewTable","dataset-table-infos":e.datasetTableInfos,class:E(e.datasetTableInfos.length>0?"":"hidden")},null,8,["dataset-table-infos","class"]),e.waitingForData?(l(),c("div",Z,ae)):e.datasetTableInfos.length===0?(l(),c("div",se,ne)):_("",!0)]),_:1})]),_:1}),t(s)]),_:1})}const ke=w(Q,[["render",re]]);export{ke as default};
//# sourceMappingURL=DatasetOverview-6691ad39.js.map
