{"version":3,"file":"DatasetOverview-06243d0b.js","sources":["../../src/components/resources/datasetOverview/DatasetOverviewTable.vue","../../src/components/pages/DatasetOverview.vue"],"sourcesContent":["<template>\n  <div class=\"col-12 text-left\">\n    <DataTable\n      :value=\"displayedDatasetTableInfos\"\n      id=\"dataset-overview-table\"\n      class=\"table-cursor mt-1\"\n      :paginator=\"true\"\n      :rows=\"100\"\n      :alwaysShowPaginator=\"false\"\n      paginatorTemplate=\"FirstPageLink PrevPageLink PageLinks NextPageLink LastPageLink CurrentPageReport\"\n      currentPageReportTemplate=\"Showing {first} to {last} of {totalRecords} entries\"\n      :rowHover=\"true\"\n      @row-click=\"rerouteRowClick\"\n      sortField=\"uploadTimeInMs\"\n      :sortOrder=\"-1\"\n      data-test=\"datasets-table\"\n    >\n      <Column field=\"companyName\" header=\"COMPANY\" :sortable=\"true\" class=\"w-3 data-test-company-name\"></Column>\n      <Column field=\"dataType\" header=\"DATA FRAMEWORK\" :sortable=\"true\" sortField=\"dataType\" class=\"w-3\">\n        <template #body=\"{ data }\">\n          {{ humanizeString(data.dataType) }}\n        </template>\n      </Column>\n      <Column field=\"dataReportingPeriod\" header=\"REPORTING PERIOD\" :sortable=\"true\"></Column>\n      <Column field=\"status\" header=\"STATUS\" :sortable=\"true\">\n        <template #body=\"{ data }\">\n          <DatasetStatusBadge :dataset-status=\"data.status\" />\n        </template>\n      </Column>\n      <Column field=\"uploadTimeInMs\" header=\"SUBMISSION DATE\" :sortable=\"true\" sortField=\"uploadTimeInMs\" class=\"w-2\">\n        <template #body=\"{ data }\">\n          <span>{{ convertDate(data.uploadTimeInMs) }}</span>\n        </template>\n      </Column>\n      <Column field=\"companyName\" header=\"\" class=\"w-2 d-bg-white d-datatable-column-right\">\n        <template #header>\n          <span class=\"w-12 p-input-icon-left p-input-icon-right\">\n            <i class=\"pi pi-search pl-3 pr-3\" aria-hidden=\"true\" style=\"color: #958d7c\" />\n            <InputText v-model=\"searchBarInput\" placeholder=\"Search table\" class=\"w-12 pl-6 pr-6\" />\n            <i v-if=\"loading\" class=\"pi pi-spin pi-spinner right-0 mr-3\" aria-hidden=\"true\"></i>\n          </span>\n        </template>\n        <template #body=\"{ data }\">\n          <router-link :to=\"getTableRowLinkTarget(data)\" class=\"text-primary no-underline font-bold\">\n            <div class=\"text-right\">\n              <span>VIEW</span>\n              <span class=\"ml-3\">></span>\n            </div>\n          </router-link>\n        </template>\n      </Column>\n    </DataTable>\n  </div>\n</template>\n\n<style>\n#dataset-overview-table tr:hover {\n  cursor: pointer;\n}\n\n#dataset-overview-table th {\n  padding-top: 0.8rem;\n  padding-bottom: 0.8rem;\n}\n</style>\n\n<script lang=\"ts\">\nimport { defineComponent } from \"vue\";\nimport DataTable from \"primevue/datatable\";\nimport Column from \"primevue/column\";\nimport { humanizeStringOrNumber } from \"@/utils/StringHumanizer\";\nimport { type DatasetTableInfo } from \"@/components/resources/datasetOverview/DatasetTableInfo\";\nimport InputText from \"primevue/inputtext\";\nimport { convertUnixTimeInMsToDateString } from \"@/utils/DataFormatUtils\";\nimport DatasetStatusBadge from \"@/components/general/DatasetStatusBadge.vue\";\n\nexport default defineComponent({\n  name: \"DatasetOverviewTable\",\n  mounted() {\n    this.displayedDatasetTableInfos = this.datasetTableInfos as DatasetTableInfo[];\n  },\n  components: {\n    DatasetStatusBadge,\n    DataTable,\n    Column,\n    InputText,\n  },\n  data() {\n    return {\n      searchBarInput: \"\",\n      displayedDatasetTableInfos: [] as DatasetTableInfo[],\n      humanizeString: humanizeStringOrNumber,\n      convertDate: convertUnixTimeInMsToDateString,\n      loading: false,\n      latestSearchString: \"\" as string,\n    };\n  },\n  props: {\n    datasetTableInfos: {\n      type: Array,\n      default: [] as DatasetTableInfo[],\n    },\n  },\n  watch: {\n    searchBarInput(newSearchString) {\n      this.applySearchFilter(newSearchString as string);\n    },\n    datasetTableInfos() {\n      this.displayedDatasetTableInfos = this.datasetTableInfos as DatasetTableInfo[];\n    },\n  },\n  methods: {\n    /**\n     * Computes the path a row click should lead to depending on the selected dataset and its status\n     * @param datasetTableInfo relevant dataset information\n     * @returns the path depending on the status of the data set\n     */\n    getTableRowLinkTarget(datasetTableInfo: DatasetTableInfo): string {\n      return `/companies/${datasetTableInfo.companyId}/frameworks/${datasetTableInfo.dataType}/${datasetTableInfo.dataId}`;\n    },\n\n    /**\n     * Filter the given datasets for the search string in the company name\n     * @param searchString The search string to look for in the company names\n     */\n    applySearchFilter(searchString: string): void {\n      this.loading = true;\n      let arrayToFilter: DatasetTableInfo[];\n      const lowerCaseSearchString = searchString.toLowerCase();\n      if (lowerCaseSearchString.includes(this.latestSearchString.toLowerCase())) {\n        arrayToFilter = this.displayedDatasetTableInfos;\n      } else {\n        arrayToFilter = this.datasetTableInfos as DatasetTableInfo[];\n      }\n      this.displayedDatasetTableInfos = arrayToFilter.filter((datasetTableInfo: DatasetTableInfo) => {\n        return datasetTableInfo.companyName.toLowerCase().includes(lowerCaseSearchString);\n      });\n      this.latestSearchString = lowerCaseSearchString;\n      this.loading = false;\n    },\n\n    /**\n     * Depending on the dataset status, executes a router push to either the dataset view page or an upload page\n     * @param event an event that stores the DatasetTableInfo of the on clicked row\n     * @param event.data the DatasetTableInfo to be pushed to\n     */\n    rerouteRowClick(event: { data: DatasetTableInfo }) {\n      void this.$router.push(this.getTableRowLinkTarget(event.data));\n    },\n  },\n});\n</script>\n","<template>\n  <AuthenticationWrapper>\n    <TheHeader />\n    <TheContent class=\"paper-section relative\">\n      <DatasetsTabMenu :initial-tab-index=\"1\">\n        <div class=\"col-12 flex flex-row justify-content-between align-items-end\">\n          <NewDatasetButton v-if=\"hasUserUploaderRights\" />\n        </div>\n        <DatasetOverviewTable\n          data-test=\"datasetOverviewTable\"\n          :dataset-table-infos=\"datasetTableInfos\"\n          :class=\"datasetTableInfos.length > 0 ? '' : 'hidden'\"\n        />\n        <div v-if=\"waitingForData\" class=\"inline-loading text-center\">\n          <p class=\"font-medium text-xl\">Loading datasets...</p>\n          <i class=\"pi pi-spinner pi-spin\" aria-hidden=\"true\" style=\"z-index: 20; color: #e67f3f\" />\n        </div>\n        <div v-else-if=\"datasetTableInfos.length === 0\">\n          <h1 class=\"mb-0\" data-test=\"noDatasetUploadedText\">No datasets uploaded</h1>\n        </div>\n      </DatasetsTabMenu>\n    </TheContent>\n    <TheFooter />\n  </AuthenticationWrapper>\n</template>\n\n<script lang=\"ts\">\nimport AuthenticationWrapper from \"@/components/wrapper/AuthenticationWrapper.vue\";\nimport TheHeader from \"@/components/generics/TheHeader.vue\";\nimport TheContent from \"@/components/generics/TheContent.vue\";\nimport { defineComponent, inject } from \"vue\";\nimport TheFooter from \"@/components/general/TheFooter.vue\";\nimport DatasetOverviewTable from \"@/components/resources/datasetOverview/DatasetOverviewTable.vue\";\nimport { assertDefined } from \"@/utils/TypeScriptUtils\";\nimport type Keycloak from \"keycloak-js\";\nimport { type DatasetTableInfo, getMyDatasetTableInfos } from \"@/components/resources/datasetOverview/DatasetTableInfo\";\nimport { checkIfUserHasRole, KEYCLOAK_ROLE_UPLOADER } from \"@/utils/KeycloakUtils\";\nimport DatasetsTabMenu from \"@/components/general/DatasetsTabMenu.vue\";\nimport NewDatasetButton from \"@/components/general/NewDatasetButton.vue\";\n\nexport default defineComponent({\n  name: \"DatasetOverview\",\n  components: {\n    NewDatasetButton,\n    DatasetsTabMenu,\n    AuthenticationWrapper,\n    TheHeader,\n    TheContent,\n    TheFooter,\n    DatasetOverviewTable,\n  },\n  data() {\n    return {\n      datasetTableInfos: [] as DatasetTableInfo[],\n      waitingForData: true,\n      hasUserUploaderRights: undefined,\n    };\n  },\n  setup() {\n    return {\n      getKeycloakPromise: inject<() => Promise<Keycloak>>(\"getKeycloakPromise\"),\n    };\n  },\n  created() {\n    checkIfUserHasRole(KEYCLOAK_ROLE_UPLOADER, this.getKeycloakPromise)\n      .then((hasUserUploaderRights) => {\n        this.hasUserUploaderRights = hasUserUploaderRights;\n      })\n      .catch((error) => console.log(error));\n    this.requestDataMetaDataForCurrentUser().catch((error) => console.log(error));\n  },\n  methods: {\n    /**\n     * Finds the datasets the logged in user is responsible for and creates corresponding table entries\n     */\n    requestDataMetaDataForCurrentUser: async function (): Promise<void> {\n      this.datasetTableInfos = await getMyDatasetTableInfos(assertDefined(this.getKeycloakPromise));\n      this.waitingForData = false;\n    },\n  },\n});\n</script>\n"],"names":["_sfc_main$1","defineComponent","DatasetStatusBadge","DataTable","Column","InputText","humanizeStringOrNumber","convertUnixTimeInMsToDateString","newSearchString","datasetTableInfo","searchString","arrayToFilter","lowerCaseSearchString","event","_hoisted_1","_hoisted_2","_hoisted_3","_createElementVNode","_hoisted_4","_hoisted_5","_component_DataTable","_resolveComponent","_openBlock","_createElementBlock","_createVNode","_ctx","_withCtx","_component_Column","data","_component_DatasetStatusBadge","_cache","$event","_createCommentVNode","_component_router_link","_sfc_main","NewDatasetButton","DatasetsTabMenu","AuthenticationWrapper","TheHeader","TheContent","TheFooter","DatasetOverviewTable","inject","checkIfUserHasRole","KEYCLOAK_ROLE_UPLOADER","hasUserUploaderRights","error","getMyDatasetTableInfos","assertDefined","_hoisted_6","_hoisted_7","_component_AuthenticationWrapper","_createBlock","_component_TheHeader","_component_TheContent","_component_DatasetsTabMenu","_component_NewDatasetButton","_component_DatasetOverviewTable","_normalizeClass","_hoisted_8"],"mappings":"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"}