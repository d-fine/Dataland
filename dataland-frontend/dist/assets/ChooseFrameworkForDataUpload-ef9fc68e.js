import{a as v,A as L}from"./ApiClients-ff4e7c51.js";import{d as T,s as B,L as S,al as M,_ as k,r as i,o as s,c as p,a as e,v as c,F as O,t as w,n as A,w as u,h as F,f as r,j as I,i as W,H as h,N as R,e as U}from"./index-727eb1c9.js";import{a as K,T as N}from"./TheHeader-5d9d243d.js";import{B as x}from"./BackButton-a0546f1c.js";import{s as z}from"./card.esm-406f8be4.js";import{C as V}from"./CompanyInformation-c5cacd20.js";import{c as q}from"./DataFormatUtils-12a7495b.js";import{h as E}from"./StringHumanizer-b303955c.js";import{D as H,a as Y}from"./DatasetStatusBadge-69ec1772.js";import{A as j}from"./AuthorizationWrapper-2f7aab5c.js";import{T as G}from"./TheFooter-3c30390c.js";import"./qa-status-272129d3.js";const J=T({name:"MetaInfoPerCompanyAndFramework",components:{PrimeButton:B,DatasetStatusBadge:H},props:{dataType:{type:String,required:!0},isWaitingForData:{type:Boolean,default:!0},companyId:{type:String,required:!0},listOfFrameworkData:{type:Array,required:!0}},data(){return{title:E(this.dataType),isFrontendViewPageExisting:null,isFrontendUploadFormExisting:null,convertUnixTimeInMsToDateString:q,getDatasetStatus:Y}},mounted(){this.isFrontendViewPageExisting=S.includes(this.dataType),this.isFrontendUploadFormExisting=M.includes(this.dataType)},computed:{dynamicButtonTitle(){return this.listOfFrameworkData.length===0?"Be the first to create this dataset":`Create another dataset for ${this.title}`}},methods:{calculateDatasetLink(t){return`/companies/${this.companyId}/frameworks/${this.dataType}/${t.dataId}`},getDynamicDatasetTitle(t){let a=`${this.title} dataset for reporting period: ${t.reportingPeriod}`;return t.currentlyActive&&(a=`${a} - latest version`),this.isFrontendViewPageExisting||(a=`${a} (only viewable via API)`),a},async redirectToUploadForm(){await this.$router.push(`/companies/${this.companyId}/frameworks/${this.dataType}/upload`)}}}),Q={key:0,class:"inline-loading text-center"},X=e("p",{class:"font-medium text-xl"},"Loading...",-1),Z=e("i",{class:"pi pi-spinner pi-spin","aria-hidden":"true",style:{"z-index":"20",color:"#e67f3f"}},null,-1),tt=[X,Z],et={key:1},at={key:1,class:"font-semibold underline"},ot={class:"mr-3"},nt={class:"mt-5"},rt={key:0},it=e("p",null," (Uploading data for this framework is currently not enabled on the Dataland frontend. You can use the Dataland API to do so.) ",-1),st=[it];function lt(t,a,o,n,l,f){const y=i("router-link"),D=i("DatasetStatusBadge"),g=i("PrimeButton");return s(),p("div",null,[e("div",null,[e("h4",null,c(t.title+" Datasets:"),1),t.isWaitingForData?(s(),p("div",Q,tt)):(s(),p("div",et,[(s(!0),p(O,null,w(t.listOfFrameworkData,(d,_)=>(s(),p("div",{key:_},[e("div",null,[this.isFrontendViewPageExisting?(s(),A(y,{key:0,to:t.calculateDatasetLink(d),class:"text-primary font-semibold underline"},{default:u(()=>[F(c(t.getDynamicDatasetTitle(d)),1)]),_:2},1032,["to"])):(s(),p("span",at,c(t.getDynamicDatasetTitle(d)),1))]),e("div",null,[e("span",ot,c(t.convertUnixTimeInMsToDateString(d.uploadTime)),1),r(D,{"dataset-status":t.getDatasetStatus(d)},null,8,["dataset-status"])])]))),128)),e("p",nt,c(t.dynamicButtonTitle),1),r(g,{class:"uppercase p-button p-button-sm d-letters mt-3",disabled:!t.isFrontendUploadFormExisting,label:"Create Dataset","data-test":"createDatasetButton",icon:"pi pi-plus",onClick:t.redirectToUploadForm},null,8,["disabled","onClick"]),t.isFrontendUploadFormExisting?I("",!0):(s(),p("div",rt,st))]))])])}const pt=k(J,[["render",lt]]),dt=T({name:"ChooseFramework",components:{TheFooter:G,AuthorizationWrapper:j,CompanyInformation:V,AuthenticationWrapper:v,TheHeader:K,BackButton:x,TheContent:N,Card:z,MetaInfoPerCompanyAndFramework:pt},setup(){return{getKeycloakPromise:W("getKeycloakPromise")}},created(){this.getMetaInfoAboutAllDataSetsForCurrentCompany()},data(){return{allFrameworksExceptEuTaxonomy:Object.values(h).filter(t=>[h.EutaxonomyFinancials,h.EutaxonomyNonFinancials].indexOf(t)===-1),waitingForData:!0,DataTypeEnum:h,humanizeString:E,mapOfDataTypeToListOfDataMetaInfo:new Map,KEYCLOAK_ROLE_UPLOADER:R}},props:{companyID:{type:String,required:!0}},methods:{buildSubtitle(t){return`Overview of all existing ${t} datasets for this company.`},sortListOfDataMetaInfoAlphabeticallyByReportingPeriod(t){return t.sort((a,o)=>a.reportingPeriod>o.reportingPeriod?-1:0),t},sortListOfDataMetaInfoByUploadTime(t){return t.sort((a,o)=>o.uploadTime-a.uploadTime)},groupListOfDataMetaInfoAsMapOfReportingPeriodToListOfDataMetaInfo(t){return t.reduce((a,o)=>{var n;return a.get(o.reportingPeriod)?(n=a.get(o.reportingPeriod))==null||n.push(o):a.set(o.reportingPeriod,[o]),a},new Map)},groupAndSortListOfDataMetaInfo(t){const a=this.sortListOfDataMetaInfoAlphabeticallyByReportingPeriod(t),o=this.groupListOfDataMetaInfoAsMapOfReportingPeriodToListOfDataMetaInfo(a),n=[];return Array.from(o.values()).forEach(l=>{n.push(...this.sortListOfDataMetaInfoByUploadTime(l))}),n},async getMetaInfoAboutAllDataSetsForCurrentCompany(){try{const o=(await(await new L(U(this.getKeycloakPromise)()).getMetaDataControllerApi()).getListOfDataMetaInfo(this.companyID,void 0,!1)).data;this.mapOfDataTypeToListOfDataMetaInfo=o.reduce((n,l)=>{var f;return n.get(l.dataType)?(f=n.get(l.dataType))==null||f.push(l):n.set(l.dataType,[l]),n},new Map),this.mapOfDataTypeToListOfDataMetaInfo.forEach((n,l)=>{this.mapOfDataTypeToListOfDataMetaInfo.set(l,this.groupAndSortListOfDataMetaInfo(n))}),this.waitingForData=!1}catch(t){console.error(t)}},getFrameworkMetaInfos(t){return this.waitingForData?[]:this.mapOfDataTypeToListOfDataMetaInfo.get(t)??[]}}}),mt={class:"uploadFormWrapper grid"},ct={id:"euTaxonomyContainer",class:"col-9 flex"},ut={id:"euTaxonomyLabel",class:"col-3 p-3"},ft=e("h3",null,"EU Taxonomy",-1),ht={class:"col-9 d-card"},yt={id:"eutaxonomyDataSetsContainer"},Dt=e("h4",{class:"bottom-border-section-dots"},"Eu Taxonomy Data Sets:",-1),gt=["id"],_t=["id"],Ft={key:0},Tt={href:"https://pathwaystoparis.com/en/tool-box/transformation-perfomance/",target:"_blank",rel:"noopener noreferrer"},kt={class:"col-9 d-card"};function Ot(t,a,o,n,l,f){const y=i("TheHeader"),D=i("BackButton"),g=i("CompanyInformation"),d=i("MetaInfoPerCompanyAndFramework"),_=i("Card"),C=i("TheContent"),P=i("AuthorizationWrapper"),$=i("TheFooter"),b=i("AuthenticationWrapper");return s(),A(b,null,{default:u(()=>[r(y),r(P,{"required-role":t.KEYCLOAK_ROLE_UPLOADER},{default:u(()=>[r(C,null,{default:u(()=>[r(D,{id:"backButton",label:"BACK"}),r(g,{companyID:t.companyID},null,8,["companyID"]),r(_,{class:"col-12 text-left page-wrapper-card"},{title:u(()=>[F(" New Dataset - Framework ")]),content:u(()=>[e("div",mt,[e("div",ct,[e("div",ut,[ft,e("p",null,c(t.buildSubtitle("EU Taxonomy")),1)]),e("div",ht,[e("div",yt,[Dt,r(d,{"data-type":t.DataTypeEnum.EutaxonomyNonFinancials,companyId:t.companyID,isWaitingForData:t.waitingForData,listOfFrameworkData:t.getFrameworkMetaInfos(t.DataTypeEnum.EutaxonomyNonFinancials),class:"bottom-border-section-dots"},null,8,["data-type","companyId","isWaitingForData","listOfFrameworkData"]),r(d,{"data-type":t.DataTypeEnum.EutaxonomyFinancials,companyId:t.companyID,isWaitingForData:t.waitingForData,listOfFrameworkData:t.getFrameworkMetaInfos(t.DataTypeEnum.EutaxonomyFinancials)},null,8,["data-type","companyId","isWaitingForData","listOfFrameworkData"])])])]),(s(!0),p(O,null,w(t.allFrameworksExceptEuTaxonomy,m=>(s(),p("div",{key:m,class:"col-9 flex top-border-section",id:m+"Container"},[e("div",{id:m+"Label",class:"col-3 p-3"},[e("h3",null,c(t.humanizeString(m)),1),e("p",null,c(t.buildSubtitle(t.humanizeString(m))),1),m===t.DataTypeEnum.P2p?(s(),p("p",Ft,[F(" Framework based on: "),e("a",Tt,c(t.humanizeString(m)),1)])):I("",!0)],8,_t),e("div",kt,[r(d,{"data-type":m,companyId:t.companyID,isWaitingForData:t.waitingForData,listOfFrameworkData:t.getFrameworkMetaInfos(m)},null,8,["data-type","companyId","isWaitingForData","listOfFrameworkData"])])],8,gt))),128))])]),_:1})]),_:1})]),_:1},8,["required-role"]),r($)]),_:1})}const Mt=k(dt,[["render",Ot]]);export{Mt as default};
//# sourceMappingURL=ChooseFrameworkForDataUpload-ef9fc68e.js.map
