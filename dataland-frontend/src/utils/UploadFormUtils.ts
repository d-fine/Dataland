import { Category, FrameworkData, Subcategory } from "@/utils/GenericFrameworkTypes";

/**
 * Creates a map of all subcategories of a framework and associates a boolean with it to decide if the
 * subcategory shall be displayed in the upload form
 * @param dataModel is the data model object generated by the Dataland devtools
 * @param formDataset is the object holding the current values in a formkit form
 */
export function createSubcategoryVisibilityMap(
  dataModel: Category[],
  formDataset: FrameworkData,
): Map<Subcategory, boolean> {
  const map = new Map<Subcategory, boolean>();
  for (const category of dataModel) {
    for (const subcategory of category.subcategories) {
      map.set(
        subcategory,
        subcategory.fields.some((field) => field.showIf(formDataset)),
      );
    }
  }
  return map;
}
