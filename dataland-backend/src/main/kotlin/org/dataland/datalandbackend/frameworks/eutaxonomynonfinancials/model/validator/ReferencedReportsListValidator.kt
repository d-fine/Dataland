// <--WARNING--> THIS FILE IS AUTO-GENERATED BY THE FRAMEWORK-TOOLBOX AND WILL BE OVERWRITTEN
package org.dataland.datalandbackend.frameworks.eutaxonomynonfinancials.model.validator

import jakarta.validation.Constraint
import jakarta.validation.ConstraintValidator
import jakarta.validation.ConstraintValidatorContext
import jakarta.validation.Payload
import org.dataland.datalandbackend.frameworks.eutaxonomynonfinancials.model.EutaxonomyNonFinancialsData
import org.dataland.datalandbackend.model.documents.CompanyReport
import kotlin.reflect.KClass

/**
* Annotation for the validation of referenced reports list for eutaxonomy-non-financials
*/

@Constraint(validatedBy = [ReferencedReportsListConstraintValidator::class])
@Target(AnnotationTarget.FIELD, AnnotationTarget.CLASS)
annotation class ReferencedReportsListValidator(
    val message: String = "The list of referenced reports is not complete. Please ensure that any file used as a " +
        "data source in the dataset is included in the list of referenced reports.",
    val groups: Array<KClass<*>> = [],
    val payload: Array<KClass<out Payload>> = [],
)

/**
* Class holding the validation logic for referenced reports list. It checks if the referenced reports list is complete
*/
class ReferencedReportsListConstraintValidator :
    ConstraintValidator<ReferencedReportsListValidator, EutaxonomyNonFinancialsData> {

    override fun isValid(dataset: EutaxonomyNonFinancialsData?, context: ConstraintValidatorContext?): Boolean {
        if (dataset == null) {
            return false
        }
        val referencedReportsMap = dataset.general?.referencedReports
        val referencedReportsFileReference = getFileReferencesFromReports(referencedReportsMap)

        val extendedDocumentsFileReferences = getExtendedDocumentReferences(dataset).filterNotNull()
        return extendedDocumentsFileReferences.all {
            referencedReportsFileReference.contains(it)
        }
    }

    private fun getFileReferencesFromReports(map: Map<String, CompanyReport>?): List<String> {
        if(map == null) return emptyList()
        val referencedReportsList = mutableListOf<String>()
            for (entry in map.entries) {
            referencedReportsList.add(entry.value.fileReference)
            }
        return referencedReportsList
    }

    @Suppress("MaxLineLength", "LongMethod")
    private fun getExtendedDocumentReferences(dataset: EutaxonomyNonFinancialsData): List<String?> {
        return listOf(
            dataset.general?.fiscalYearDeviation?.dataSource?.fileReference,
            dataset.general?.fiscalYearEnd?.dataSource?.fileReference,
            dataset.general?.scopeOfEntities?.dataSource?.fileReference,
            dataset.general?.nfrdMandatory?.dataSource?.fileReference,
            dataset.general?.euTaxonomyActivityLevelReporting?.dataSource?.fileReference,
            dataset.general?.assurance?.dataSource?.fileReference,
            dataset.general?.numberOfEmployees?.dataSource?.fileReference,
            dataset.general?.unGlobalCompactPrinciplesCompliancePolicy?.dataSource?.fileReference,
            dataset.general?.oecdGuidelinesForMultinationalEnterprisesCompliancePolicy?.dataSource?.fileReference,
            dataset.general?.iloCoreLabourStandards?.dataSource?.fileReference,
            dataset.general?.humanRightsDueDiligence?.dataSource?.fileReference,
            dataset.revenue?.totalAmount?.dataSource?.fileReference,
            dataset.revenue?.nonEligibleShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.revenue?.nonEligibleShare?.absoluteShare?.dataSource?.fileReference,
            dataset.revenue?.eligibleShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.revenue?.eligibleShare?.absoluteShare?.dataSource?.fileReference,
            dataset.revenue?.nonAlignedShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.revenue?.nonAlignedShare?.absoluteShare?.dataSource?.fileReference,
            dataset.revenue?.alignedShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.revenue?.alignedShare?.absoluteShare?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeMitigationInPercentEligible?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeMitigationInPercentAligned?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeMitigationInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeMitigationInPercentEnablingShare?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeMitigationInPercentTransitionalShare?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeAdaptationInPercentEligible?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeAdaptationInPercentAligned?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeAdaptationInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToClimateChangeAdaptationInPercentEnablingShare?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentEligible?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentAligned?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentEnablingShare?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToTransitionToACircularEconomyInPercentEligible?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToTransitionToACircularEconomyInPercentAligned?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToTransitionToACircularEconomyInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToTransitionToACircularEconomyInPercentEnablingShare?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToPollutionPreventionAndControlInPercentEligible?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToPollutionPreventionAndControlInPercentAligned?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToPollutionPreventionAndControlInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToPollutionPreventionAndControlInPercentEnablingShare?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentEligible?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentAligned?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.revenue?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentEnablingShare?.dataSource?.fileReference,
            dataset.revenue?.enablingShareInPercent?.dataSource?.fileReference,
            dataset.revenue?.transitionalShareInPercent?.dataSource?.fileReference,
            dataset.capex?.totalAmount?.dataSource?.fileReference,
            dataset.capex?.nonEligibleShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.capex?.nonEligibleShare?.absoluteShare?.dataSource?.fileReference,
            dataset.capex?.eligibleShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.capex?.eligibleShare?.absoluteShare?.dataSource?.fileReference,
            dataset.capex?.nonAlignedShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.capex?.nonAlignedShare?.absoluteShare?.dataSource?.fileReference,
            dataset.capex?.alignedShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.capex?.alignedShare?.absoluteShare?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeMitigationInPercentEligible?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeMitigationInPercentAligned?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeMitigationInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeMitigationInPercentEnablingShare?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeMitigationInPercentTransitionalShare?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeAdaptationInPercentEligible?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeAdaptationInPercentAligned?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeAdaptationInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToClimateChangeAdaptationInPercentEnablingShare?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentEligible?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentAligned?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentEnablingShare?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToTransitionToACircularEconomyInPercentEligible?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToTransitionToACircularEconomyInPercentAligned?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToTransitionToACircularEconomyInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToTransitionToACircularEconomyInPercentEnablingShare?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToPollutionPreventionAndControlInPercentEligible?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToPollutionPreventionAndControlInPercentAligned?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToPollutionPreventionAndControlInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToPollutionPreventionAndControlInPercentEnablingShare?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentEligible?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentAligned?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentOfWhichUseOfProceeds?.dataSource?.fileReference,
            dataset.capex?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentEnablingShare?.dataSource?.fileReference,
            dataset.capex?.enablingShareInPercent?.dataSource?.fileReference,
            dataset.capex?.transitionalShareInPercent?.dataSource?.fileReference,
            dataset.opex?.totalAmount?.dataSource?.fileReference,
            dataset.opex?.nonEligibleShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.opex?.nonEligibleShare?.absoluteShare?.dataSource?.fileReference,
            dataset.opex?.eligibleShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.opex?.eligibleShare?.absoluteShare?.dataSource?.fileReference,
            dataset.opex?.nonAlignedShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.opex?.nonAlignedShare?.absoluteShare?.dataSource?.fileReference,
            dataset.opex?.alignedShare?.relativeShareInPercent?.dataSource?.fileReference,
            dataset.opex?.alignedShare?.absoluteShare?.dataSource?.fileReference,
            dataset.opex?.substantialContributionToClimateChangeMitigationInPercentAligned?.dataSource?.fileReference,
            dataset.opex?.substantialContributionToClimateChangeAdaptationInPercentAligned?.dataSource?.fileReference,
            dataset.opex?.substantialContributionToSustainableUseAndProtectionOfWaterAndMarineResourcesInPercentAligned?.dataSource?.fileReference,
            dataset.opex?.substantialContributionToTransitionToACircularEconomyInPercentAligned?.dataSource?.fileReference,
            dataset.opex?.substantialContributionToPollutionPreventionAndControlInPercentAligned?.dataSource?.fileReference,
            dataset.opex?.substantialContributionToProtectionAndRestorationOfBiodiversityAndEcosystemsInPercentAligned?.dataSource?.fileReference,
            dataset.opex?.enablingShareInPercent?.dataSource?.fileReference,
            dataset.opex?.transitionalShareInPercent?.dataSource?.fileReference,
        )
    }
}