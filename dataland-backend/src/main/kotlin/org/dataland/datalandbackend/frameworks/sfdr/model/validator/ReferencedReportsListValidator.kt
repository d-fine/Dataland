// <--WARNING--> THIS FILE IS AUTO-GENERATED BY THE FRAMEWORK-TOOLBOX AND WILL BE OVERWRITTEN
package org.dataland.datalandbackend.frameworks.sfdr.model.validator

import jakarta.validation.Constraint
import jakarta.validation.ConstraintValidator
import jakarta.validation.ConstraintValidatorContext
import jakarta.validation.Payload
import org.dataland.datalandbackend.frameworks.sfdr.model.SfdrData
import org.dataland.datalandbackend.model.documents.CompanyReport
import kotlin.reflect.KClass

/**
* Annotation for the validation of referenced reports list for sfdr
*/

@Constraint(validatedBy = [ReferencedReportsListConstraintValidator::class])
@Target(AnnotationTarget.FIELD, AnnotationTarget.CLASS)
annotation class ReferencedReportsListValidator(
    val message: String = "The list of referenced reports is not complete. Please ensure that any file used as a " +
        "data source in the dataset is included in the list of referenced reports.",
    val groups: Array<KClass<*>> = [],
    val payload: Array<KClass<out Payload>> = [],
)

/**
* Class holding the validation logic for referenced reports list. It checks if the referenced reports list is complete
*/
class ReferencedReportsListConstraintValidator :
    ConstraintValidator<ReferencedReportsListValidator, SfdrData> {

    override fun isValid(dataset: SfdrData?, context: ConstraintValidatorContext?): Boolean {
        if (dataset == null) {
            return false
        }
        val referencedReportsMap = dataset.general.general.referencedReports
        val referencedReportsFileReference = getFileReferencesFromReports(referencedReportsMap)

        val extendedDocumentsFileReferences = getExtendedDocumentReferences(dataset).filterNotNull()
        return extendedDocumentsFileReferences.all {
            referencedReportsFileReference.contains(it)
        }
    }

    private fun getFileReferencesFromReports(map: Map<String, CompanyReport>?): List<String> {
        if(map == null) return emptyList()
        val referencedReportsList = mutableListOf<String>()
            for (entry in map.entries) {
            referencedReportsList.add(entry.value.fileReference)
            }
        return referencedReportsList
    }

    @Suppress("MaxLineLength", "LongMethod")
    private fun getExtendedDocumentReferences(dataset: SfdrData): List<String?> {
        return listOf(
            dataset.environmental?.greenhouseGasEmissions?.scope1GhgEmissionsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope2GhgEmissionsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope2GhgEmissionsLocationBasedInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope2GhgEmissionsMarketBasedInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope1And2GhgEmissionsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope1And2GhgEmissionsLocationBasedInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope1And2GhgEmissionsMarketBasedInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope3GhgEmissionsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope3UpstreamGhgEmissionsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope3DownstreamGhgEmissionsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope1And2And3GhgEmissionsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope1And2And3GhgEmissionsLocationBasedInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope1And2And3GhgEmissionsMarketBasedInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.scope4GhgEmissionsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.enterpriseValue?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.totalRevenue?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.carbonFootprintInTonnesPerMillionEURRevenue?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.ghgIntensityInTonnesPerMillionEURRevenue?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.ghgIntensityScope1InTonnesPerMillionEURRevenue?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.ghgIntensityScope2InTonnesPerMillionEURRevenue?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.ghgIntensityScope3InTonnesPerMillionEURRevenue?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.ghgIntensityScope4InTonnesPerMillionEURRevenue?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.fossilFuelSectorExposure?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.financedScope1AndScope2Emissions?.dataSource?.fileReference,
            dataset.environmental?.greenhouseGasEmissions?.financedScope3Emissions?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.renewableEnergyProductionInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.renewableEnergyConsumptionInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyProductionInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.relativeNonRenewableEnergyProductionInPercent?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyConsumptionInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.relativeNonRenewableEnergyConsumptionInPercent?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.totalHighImpactClimateSectorEnergyConsumptionInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyConsumptionFossilFuelsInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyConsumptionCrudeOilInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyConsumptionNaturalGasInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyConsumptionLigniteInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyConsumptionCoalInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyConsumptionNuclearEnergyInGWh?.dataSource?.fileReference,
            dataset.environmental?.energyPerformance?.nonRenewableEnergyConsumptionOtherInGWh?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.primaryForestAndWoodedLandOfNativeSpeciesExposure?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.protectedAreasExposure?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.rareOrEndangeredEcosystemsExposure?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.highlyBiodiverseGrasslandExposure?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.manufactureOfAgrochemicalPesticidesProducts?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.landDegradationDesertificationSoilSealingExposure?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.sustainableAgriculturePolicy?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.sustainableOceansAndSeasPolicy?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.threatenedSpeciesExposure?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.biodiversityProtectionPolicy?.dataSource?.fileReference,
            dataset.environmental?.biodiversity?.deforestationPolicy?.dataSource?.fileReference,
            dataset.environmental?.water?.emissionsToWaterInTonnes?.dataSource?.fileReference,
            dataset.environmental?.water?.waterConsumptionInCubicMeters?.dataSource?.fileReference,
            dataset.environmental?.water?.waterReusedInCubicMeters?.dataSource?.fileReference,
            dataset.environmental?.water?.relativeWaterUsageInCubicMetersPerMillionEURRevenue?.dataSource?.fileReference,
            dataset.environmental?.water?.waterManagementPolicy?.dataSource?.fileReference,
            dataset.environmental?.water?.highWaterStressAreaExposure?.dataSource?.fileReference,
            dataset.environmental?.waste?.hazardousAndRadioactiveWasteInTonnes?.dataSource?.fileReference,
            dataset.environmental?.waste?.nonRecycledWasteInTonnes?.dataSource?.fileReference,
            dataset.environmental?.emissions?.emissionsOfInorganicPollutantsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.emissions?.emissionsOfAirPollutantsInTonnes?.dataSource?.fileReference,
            dataset.environmental?.emissions?.emissionsOfOzoneDepletionSubstancesInTonnes?.dataSource?.fileReference,
            dataset.environmental?.emissions?.carbonReductionInitiatives?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.humanRightsLegalProceedings?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.iloCoreLabourStandards?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.environmentalPolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.corruptionLegalProceedings?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.transparencyDisclosurePolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.humanRightsDueDiligencePolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.policyAgainstChildLabour?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.policyAgainstForcedLabour?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.policyAgainstDiscriminationInTheWorkplace?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.iso14001Certificate?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.policyAgainstBriberyAndCorruption?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.fairBusinessMarketingAdvertisingPolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.technologiesExpertiseTransferPolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.fairCompetitionPolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.violationOfTaxRulesAndRegulation?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.unGlobalCompactPrinciplesCompliancePolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.oecdGuidelinesForMultinationalEnterprisesGrievanceHandling?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.averageGrossHourlyEarningsMaleEmployees?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.averageGrossHourlyEarningsFemaleEmployees?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.unadjustedGenderPayGapInPercent?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.femaleBoardMembersSupervisoryBoard?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.femaleBoardMembersBoardOfDirectors?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.maleBoardMembersSupervisoryBoard?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.maleBoardMembersBoardOfDirectors?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.boardGenderDiversitySupervisoryBoardInPercent?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.boardGenderDiversityBoardOfDirectorsInPercent?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.controversialWeaponsExposure?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.workplaceAccidentPreventionPolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.rateOfAccidents?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.workdaysLostInDays?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.supplierCodeOfConduct?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.grievanceHandlingMechanism?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.whistleblowerProtectionPolicy?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.reportedIncidentsOfDiscrimination?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.sanctionedIncidentsOfDiscrimination?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.ceoToEmployeePayGapRatio?.dataSource?.fileReference,
            dataset.social?.socialAndEmployeeMatters?.excessiveCeoPayRatioInPercent?.dataSource?.fileReference,
            dataset.social?.greenSecurities?.securitiesNotCertifiedAsGreen?.dataSource?.fileReference,
            dataset.social?.humanRights?.humanRightsPolicy?.dataSource?.fileReference,
            dataset.social?.humanRights?.humanRightsDueDiligence?.dataSource?.fileReference,
            dataset.social?.humanRights?.traffickingInHumanBeingsPolicy?.dataSource?.fileReference,
            dataset.social?.humanRights?.reportedChildLabourIncidents?.dataSource?.fileReference,
            dataset.social?.humanRights?.reportedForcedOrCompulsoryLabourIncidents?.dataSource?.fileReference,
            dataset.social?.humanRights?.numberOfReportedIncidentsOfHumanRightsViolations?.dataSource?.fileReference,
            dataset.social?.antiCorruptionAndAntiBribery?.casesOfInsufficientActionAgainstBriberyAndCorruption?.dataSource?.fileReference,
            dataset.social?.antiCorruptionAndAntiBribery?.reportedConvictionsOfBriberyAndCorruption?.dataSource?.fileReference,
            dataset.social?.antiCorruptionAndAntiBribery?.totalAmountOfReportedFinesOfBriberyAndCorruption?.dataSource?.fileReference,
        )
    }
}